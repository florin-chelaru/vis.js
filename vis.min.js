(function(){/*
 vis.js
 Copyright (c) 2015 Florin Chelaru
 License: MIT

 Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
 documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
 permit persons to whom the Software is furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all copies or substantial portions of the
 Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
 OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
'use strict';var n;var aa=this;Math.random();function q(a,b){var d=a.split("."),c=aa;d[0]in c||!c.execScript||c.execScript("var "+d[0]);for(var e;d.length&&(e=d.shift());)d.length||void 0===b?c[e]?c=c[e]:c=c[e]={}:c[e]=b}function r(a,b){function d(){}d.prototype=b.prototype;a.Za=b.prototype;a.prototype=new d;a.prototype.constructor=a;a.Ya=function(a,d,f){for(var h=Array(arguments.length-2),g=2;g<arguments.length;g++)h[g-2]=arguments[g];return b.prototype[d].apply(a,h)}};function v(a,b){this.M=ba++;this.Ka=a;this.Ra=b;this.wa=this.xa=null;this.sa=this;this.ua=this}
Object.defineProperties(v.prototype,{id:{get:function(){return this.M}},thisArg:{get:function(){return this.Ra}},func:{get:function(){return this.Ka}},prev:{get:function(){return this.xa},set:function(a){this.xa=a}},next:{get:function(){return this.wa},set:function(a){this.wa=a}},first:{get:function(){return this.sa},set:function(a){this.sa=a}},last:{get:function(){return this.ua},set:function(a){this.ua=a}}});var ba=0;function w(){this.C={}}w.prototype.T=function(a,b){var d=new v(a,b);return this.C[d.id]=d};w.prototype.a=function(a,b){if("function"==typeof a)return this.a(new v(a),b);if("function"==typeof b)return this.a(a,new v(b));a.next=a.next||b.first;a.last.next=b.first;a.last=b.last;b.prev=b.prev||a.last;b.first.prev=a.last;return b.first=a.first};
w.prototype.j=function(a,b){var d=a.first;if(b)return new Promise(function(a){for(;d;d=d.next)d.func.apply(d.thisArg);a()});for(var c=[];d;d=d.next)c.push(d);return u.async.each(c,function(a){return a.func.apply(a.thisArg)},!0)};function x(a){this.target=a.target;this.test=a.test;this.testArgs=a.testArgs;this.negate=!!a.negate}x.prototype.toString=function(){var a=void 0===this.testArgs?"undefined":JSON.stringify(this.testArgs),a=this.target+" "+this.test+" "+a;return this.negate?"not("+a+")":a};x.prototype.equals=function(a){return a?this.toString()==(new x(a)).toString():!1};var y={EQUALS:"==",GREATER_THAN:">",LESS_THAN:"<",GREATER_OR_EQUALS:">=",LESS_OR_EQUALS:"<=",CONTAINS:"contains",IN:"in",DEFINED:"defined"};function z(){this.ta=this.ga=this.ea=this.da=this.M=null}Object.defineProperties(z.prototype,{id:{get:function(){this.M||(this.M=u.generatePseudoGUID(6));return this.M}},changed:{get:function(){this.da||(this.da=new u.Event);return this.da}},changing:{get:function(){this.ea||(this.ea=new u.Event);return this.ea}},ready:{get:function(){this.ga||(this.ga=Promise.resolve(this));return this.ga}},isReady:{get:function(){return void 0==this.ta?!0:this.ta}}});
z.prototype.X=function(a,b){a instanceof x&&(a=[a]);if(!a||!a.length)return Promise.resolve(this);var d=this,c=this;return new Promise(function(e,f){d.ready.then(function(){u.async.each(a,function(a){return new Promise(function(b,d){ca(c,a).then(function(a){c=a;b()},d)})},!0).then(function(){b?e(c):(d.id=c.id,d.query=c.query,d.rowMetadata=c.rowMetadata,d.d=c.d,d.metadata=c.metadata,d.label=c.label,d.state=c.state,e(d),d.changed.fire(d))},f)},f)})};
z.prototype.filter=function(a){return z.prototype.X.call(this,a,!0)};
function ca(a,b){if(!b)return Promise.resolve(a);var d=a;return new Promise(function(c,e){try{var f=u.fast.filter(a.d,function(a,d){var c=!0,e=void 0!=b.target?a[b.target]:d;try{switch(b.test){case y.EQUALS:c=e==b.testArgs;break;case y.GREATER_OR_EQUALS:c=e>=b.testArgs;break;case y.GREATER_THAN:c=e>b.testArgs;break;case y.LESS_OR_EQUALS:c=e<=b.testArgs;break;case y.LESS_THAN:c=e<b.testArgs;break;case y.CONTAINS:c=0<=e.indexOf(b.testArgs);break;case y.IN:c=e in b.testArgs;break;case y.DEFINED:c=void 0!==
e;break;default:c=!1}}catch(f){c=!1}return!b.negate&&c||b.negate&&!c});d=u.reflection.wrap({id:d.id,query:d.query.concat([b]),rowMetadata:d.rowMetadata,metadata:d.metadata,d:f,label:d.label,state:u.generatePseudoGUID(6)},z);c(d)}catch(h){e(h)}})}z.prototype.raw=function(){return{id:this.id,label:this.label,query:this.query,rowMetadata:this.rowMetadata,metadata:this.metadata,d:this.d,state:this.state}};
z.prototype.Z=function(a){var b;return this.rowMetadata.some(function(d){b=d;return d.label==a})?b:null};function da(a){return u.array.uniqueFast(u.fast.concat(u.fast.map(a,function(a){return u.fast.map(a.rowMetadata,function(a){return a.label})})))}function ea(a){return a.every(function(a){return a.isReady})}var fa={STRING:"string",NUMBER:"number",BOOLEAN:"boolean",FACTOR:"factor"};function A(a,b,d,c){this.Aa=a;this.va=b;this.qa=d;this.ya=c}Object.defineProperties(A.prototype,{top:{get:function(){return this.Aa},set:function(a){this.Aa=a}},left:{get:function(){return this.va},set:function(a){this.va=a}},bottom:{get:function(){return this.qa},set:function(a){this.qa=a}},right:{get:function(){return this.ya},set:function(a){this.ya=a}},x:{get:function(){return[this.left,this.right]}},y:{get:function(){return[this.top,this.bottom]}}});
A.prototype.add=function(a){return new A(this.top+a.top,this.left+a.left,this.bottom+a.bottom,this.right+a.right)};A.prototype.equals=function(a){return!!a&&this.top==a.top&&this.left==a.left&&this.bottom==a.bottom&&this.right==a.right};function C(a,b){this.min=a;this.max=b};function D(a){this.key=a.key;this.type=a.type;this.defaultValue=a.defaultValue;this.label=a.label||this.key;this.a=a.possibleValues||null;this.template=a.template;this.hidden=!!a.hidden;this.dependencies=a.dependencies}
D.prototype.D=function(a,b,d,c){function e(){return"function"==typeof f.defaultValue?f.defaultValue.call(null,f,a,b,d,c):f.defaultValue}var f=this;if(!(a&&this.key in a||b&&this.key in b))return e();var h,g=a&&this.key in a?a[this.key]:b[this.key];switch(this.type){case E.BOOLEAN:return"boolean"==typeof g?g:"true"==g?!0:"false"==g?!1:e();case E.NUMBER:if("number"==typeof g)return g;try{return g=parseFloat(g),isNaN(g)?e():g}catch(p){return e()}case E.STRING:return"string"==typeof g?g:"number"==typeof g?
""+g:e();case E.DATA_ROW_LABEL:if(!d)return g;h=this.j(a,b,d,c);return 0>h.indexOf(g)?0<h.length?h[0]:e():g;case E.DATA_COL_LABEL:if(!d)return g;h=this.j(a,b,d,c);return 0>h.indexOf(g)?0<h.length?h[0]:e():g;case E.DATA_VAL_LABEL:if(!d)return g;h=this.j(a,b,d,c);return 0>h.indexOf(g)?0<h.length?h[0]:e():g;case E.ARRAY:if(Array.isArray(g))return g;if("string"==typeof g)try{return g=JSON.parse(g),Array.isArray(g)?g:e()}catch(l){}return e();case E.CATEGORICAL:if(null===this.a)return g;h="function"==typeof this.a?
this.a.call(null,this,a,b,d,c):this.a;return 0>h.indexOf(g)?e():g;case E.OBJECT:if("object"==typeof g)return g;if("string"==typeof g)try{return JSON.parse(g)}catch(k){}return e();case E.FUNCTION:return"function"==typeof g?g:e();default:try{h=u.reflection.evaluateFullyQualifiedTypeName(this.type);if("object"==typeof g)return u.reflection.wrap(g,h);if("string"==typeof g){var m=JSON.parse(g);return u.reflection.wrap(m,h)}return e()}catch(t){return e()}}};
D.prototype.j=function(a,b,d,c){if(this.a)return"function"!=typeof this.a?this.a:this.a.call(null,this,a,b,d,c);if(!d)return null;switch(this.type){case E.DATA_ROW_LABEL:return da(d);case E.DATA_COL_LABEL:return u.fast.map(d,function(a){return a.label});case E.DATA_COL_ID:return u.fast.map(d,function(a){return a.id});default:return null}};
D.prototype.copy=function(a){return new D({key:a.key||this.key,type:a.type||this.type,defaultValue:a.defaultValue||this.defaultValue,label:a.label||this.label,template:a.template||this.template,hidden:a.hidden||this.hidden,possibleValues:a.possibleValues||this.a,dependencies:u.extend({},this.dependencies||{},a.dependencies||{})})};
var E={NUMBER:"number",STRING:"string",ARRAY:"array",BOOLEAN:"boolean",OBJECT:"object",CATEGORICAL:"categorical",DATA_COL_LABEL:"dataColLbl",DATA_COL_ID:"dataColId",DATA_ROW_LABEL:"dataRowLbl",FUNCTION:"function"};function ga(a,b){return u.fast.map(a,function(a){a=a.Z(b);return void 0==a?null:a.type}).reduce(function(a,b){return a==b?a:null==a?b:null==b?a:fa.STRING})}
function ha(a,b,d,c,e,f){var h,g=a.dependencies;if(!f)throw new F('Settings not provided for "'+a.key+'", which depends on '+JSON.stringify(g));u.each(g,function(a,b){if(!(b in f))throw new F('Missing dependency for "'+b+'" in the "mergeCols" defaultValue function');});var p=f[g[b]].D(d,c,e,f),l,k;switch(ga(e,p)){case fa.NUMBER:u.fast.forEach(e,function(a){a=a.Z(p);if(null!=a&&"boundaries"in a){if(void 0==l||l>a.boundaries.min)l=a.boundaries.min;if(void 0==k||k<a.boundaries.max)k=a.boundaries.max}});
void 0!=l&&void 0!=k&&(h=new C(l,k));void 0==h&&(a=u.fast.concat(u.fast.map(e,function(a){return u.fast.map(a.d,function(a){return a[p]})})),l=Math.min.apply(null,a),k=Math.max.apply(null,a),void 0!=l&&void 0!=k&&(h=new C(l,k)));break;case fa.BOOLEAN:h=new C(0,1);break;case fa.FACTOR:l=0;u.fast.forEach(e,function(a){a=a.Z(p);null!=a&&"levels"in a&&(void 0==k||k<a.levels.length)&&(k=a.levels.length)});void 0!=l&&void 0!=k&&(h=new C(l,k-1));break;default:h=u.array.uniqueFast(u.fast.concat(u.fast.map(e,
function(a){return u.fast.map(a.d,function(a){return a[p]})}))),l=0,k=h.length-1,h=new C(l,k)}if(void 0==h)throw new F("Boundaries could not be determined");return h}function ia(a,b,d,c,e){return ha(a,"xField",b,d,c,e)}function ja(a,b,d,c,e){return ha(a,"yField",b,d,c,e)}function ka(a,b,d,c){return c.length?c[0].id:null}function la(a,b,d,c){return c.length?c[0].rowMetadata[0].label:null}
function ma(a,b,d,c){for(a=0;a<c.length;++a)for(b=c[a].rowMetadata,d=0;d<b.length;++d)if(ga(c,b[d].label)==fa.NUMBER)return b[d].label;return null}
function na(a,b,d,c,e){var f=a.dependencies;if(!e)throw new F('Settings not provided for "xScale", which depends on '+JSON.stringify(f));u.each(f,function(a,b){if(!(b in e))throw new F('Missing dependency for "'+b+'" in the "xScale" defaultValue function');});a=e[f.xBoundaries].D(b,d,c,e);var h=e[f.width].D(b,d,c,e);b=e[f.margins].D(b,d,c,e);return d3.scale.linear().domain([a.min,a.max]).range([0,h-b.left-b.right])}
function oa(a,b,d,c,e){var f=a.dependencies;if(!e)throw new F('Settings not provided for "'+a.key+'", which depends on '+JSON.stringify(f));u.each(f,function(a,b){if(!(b in e))throw new F('Missing dependency for "'+b+'" in the "yScale" defaultValue function');});a=e[f.yBoundaries].D(b,d,c,e);var h=e[f.height].D(b,d,c,e);b=e[f.margins].D(b,d,c,e);return d3.scale.linear().domain([a.min,a.max]).range([h-b.top-b.bottom,0])}
function pa(a,b){for(var d={id:u.fast.map(b,function(a){return a.id}).join("-"),label:u.fast.map(b,function(a){return a.label}).join(", "),rowMetadata:u.array.unique(u.fast.concat(u.fast.map(b,function(a){return a.rowMetadata}))),query:[],metadata:{}},c={},e=[],f=0;f<b.length;++f)for(var h=b[f].d,g=0;g<h.length;++g){var p=h[g],l=p[a],k=c[l];k||(k={},k[a]=l,c[l]=k,e.push(k));k[p.__d__]=p}e.sort(function(b,c){return b[a]==c[a]?0:b[a]<c[a]?-1:1});d.d=e;return u.reflection.wrap(d,z)}
function G(a,b){this.label=a;this.func=b}
var H={col:new D({key:"col",type:E.DATA_COL_ID,defaultValue:ka,label:"column",template:"_categorical.html"}),xField:new D({key:"xField",type:E.DATA_ROW_LABEL,defaultValue:ma,label:"x values",template:"_categorical.html"}),yField:new D({key:"yField",type:E.DATA_ROW_LABEL,defaultValue:ma,label:"y values",template:"_categorical.html"}),xBoundaries:new D({key:"xBoundaries",type:"vs.models.Boundaries",defaultValue:ia,label:"x boundaries",dependencies:{xField:"xField"},template:"_boundaries.html"}),yBoundaries:new D({key:"yBoundaries",
type:"vs.models.Boundaries",defaultValue:ja,label:"y boundaries",dependencies:{yField:"yField"},template:"_boundaries.html"}),x:new D({key:"x",type:E.NUMBER,defaultValue:0}),y:new D({key:"y",type:E.NUMBER,defaultValue:0}),margins:new D({key:"margins",type:"vs.models.Margins",defaultValue:function(){return new A(0,0,0,0)}}),width:new D({key:"width",type:E.NUMBER,defaultValue:300}),height:new D({key:"height",type:E.NUMBER,defaultValue:300}),cols:new D({key:"cols",type:E.ARRAY,defaultValue:function(a,
b,d,c){return u.fast.map(c,function(a){return a.id})},label:"columns",template:"_multiselect-tbl.html",possibleValues:function(a,b,d,c){return u.fast.map(c,function(a){return a.id})}}),xVals:new D({key:"xVals",type:E.ARRAY,defaultValue:function(a,b,d,c){return da(c)},label:"xs",template:"_multiselect-tbl.html"}),yVals:new D({key:"yVals",type:E.ARRAY,defaultValue:function(a,b,d,c){return da(c)},label:"ys",template:"_multiselect-tbl.html"}),rowsOrderBy:new D({key:"rowsOrderBy",type:E.DATA_ROW_LABEL,
defaultValue:la,label:"order rows by",template:"_categorical.html"}),rowsScale:new D({key:"rowsScale",type:E.BOOLEAN,defaultValue:!0,label:"scale rows axis",template:"_switch.html"}),doubleBuffer:new D({key:"doubleBuffer",type:E.BOOLEAN,defaultValue:!0,label:"double buffer",template:"_switch.html"}),xScale:new D({key:"xScale",type:"vs.ui.Setting.FunctionWrapper",defaultValue:new G("linear",na),dependencies:{xBoundaries:"xBoundaries",width:"width",margins:"margins"},template:"_function.html",possibleValues:[new G("linear",
na)]}),yScale:new D({key:"yScale",type:"vs.ui.Setting.FunctionWrapper",defaultValue:new G("linear",oa),dependencies:{yBoundaries:"yBoundaries",height:"height",margins:"margins"},template:"_function.html",possibleValues:[new G("linear",oa)]}),fill:new D({key:"fill",type:E.STRING,defaultValue:"rgba(30,96,212,0.3)",label:"object fill",template:"_color.html"}),fills:new D({key:"fills",type:"vs.ui.Setting.FunctionWrapper",defaultValue:new G("category20",function(){return d3.scale.category20()}),label:"object fill",
template:"_function.html",possibleValues:[new G("category20",function(){return d3.scale.category20()}),new G("category10",function(){return d3.scale.category10()})]}),fillOpacity:new D({key:"fillOpacity",type:E.NUMBER,defaultValue:.3,label:"fill opacity"}),stroke:new D({key:"stroke",type:E.STRING,defaultValue:"rgba(30,96,212,1)",label:"object stroke",template:"_color.html"}),strokes:new D({key:"strokes",type:"vs.ui.Setting.FunctionWrapper",defaultValue:new G("category20",function(){return d3.scale.category20()}),
label:"object stroke",template:"_function.html",possibleValues:[new G("category20",function(){return d3.scale.category20()}),new G("category10",function(){return d3.scale.category10()})]}),strokeThickness:new D({key:"strokeThickness",type:E.NUMBER,defaultValue:1,label:"stroke thickness",template:"_number.html"}),selectFill:new D({key:"selectFill",type:E.STRING,defaultValue:"#ff6520",label:"selected object fill",template:"_color.html"}),selectStroke:new D({key:"selectStroke",type:E.STRING,defaultValue:"#ffc600",
label:"selected object stroke",template:"_color.html"}),selectStrokeThickness:new D({key:"selectStrokeThickness",type:E.NUMBER,defaultValue:2,label:"selected stroke thickness",template:"_number.html"}),mergeCols:new D({key:"mergeCols",type:E.FUNCTION,defaultValue:function(a,b,d,c,e){b=a.dependencies;if(!e)throw new F('Settings not provided for "'+a.key+'", which depends on '+JSON.stringify(b));u.each(b,function(a,b){if(!(b in e))throw new F('Missing dependency for "'+b+'" in the "mergeCols" defaultValue function');
});return pa},dependencies:{xCol:"xCol"},hidden:!0})};function I(a,b,d,c){this.W=a.$scope;this.ba=a.$element;this.aa=a.$attrs;this.K=a.$timeout;this.Fa=b;this.za=d;this.ca=a.taskService.T(this.B,this);this.fa=a.taskService.T(this.m,this);this.F=c}
Object.defineProperties(I.prototype,{$scope:{get:function(){return this.W}},$element:{get:function(){return this.ba}},$attrs:{get:function(){return this.aa}},$targetElement:{get:function(){return this.Fa}},data:{get:function(){return this.za.data}},target:{get:function(){return this.za}},options:{get:function(){return this.F}},settings:{get:function(){return{}}},beginDrawTask:{get:function(){return this.ca}},endDrawTask:{get:function(){return this.fa}}});
I.prototype.l=function(a){return a in this.settings?this.settings[a].D(this.options,this.$attrs,this.data,this.settings):null};I.prototype.B=function(){return Promise.resolve()};I.prototype.m=function(){return Promise.resolve()};function J(a,b,d,c){I.apply(this,arguments)}r(J,I);var qa={type:new D({key:"type",type:E.CATEGORICAL,defaultValue:"x",possibleValues:["x","y"]}),ticks:new D({key:"ticks",type:E.NUMBER,defaultValue:10}),format:new D({key:"format",type:E.STRING,defaultValue:"s"}),label:new D({key:"label",type:E.STRING,defaultValue:null})},sa={x:"bottom",y:"left"};
Object.defineProperties(J.prototype,{settings:{get:function(){return qa}},type:{get:function(){return this.l("type")}},ticks:{get:function(){return this.l("ticks")}},format:{get:function(){return this.l("format")}},label:{get:function(){var a=this.l("label");return void 0!=a?a:(a=this.target.l(this.type+"Label"))||""}}});function K(a,b,d,c){J.apply(this,arguments)}r(K,J);
K.prototype.m=function(){var a=this,b=arguments;return(new Promise(function(b){if(ea(a.target.data)){var c=a.target,e=d3.select(c.$element[0]).select("svg"),f=a.type,h="vs-axis-"+f,g=e.select("."+h);g.empty()&&(g=e.insert("g",".viewport").attr("class",h));var p=c.height,e=c.width,l=c.margins,h={x:l.left,y:p-l.bottom},k="x"==f?c.V("xScale"):c.V("yScale");if(!k)throw new F('Visualization must have "xScale"/"yScale" settings defined in order to use the Axis decorator');k=d3.svg.axis().scale(k).orient(sa[f]).ticks(a.ticks);
a.format&&(k=k.tickFormat(d3.format(a.format)));g.call(k);var m=a.label;if(m){var t=g.select(".vs-label");t.empty()&&(k=g[0][0].getBBox(),t=g.append("text").attr("class","vs-label").attr("font-weight","bold").attr("fill","#000000").attr("text-anchor","middle"),"x"==f?t.attr("alignment-baseline","before-edge").attr("y",k.height):t.attr("alignment-baseline","after-edge").attr("transform","rotate(-90)translate(0,"+-k.width+")"));t.text(m);"x"==f?t.attr("x",.5*(e-l.left-l.right)):(k=t.attr("transform"),
t.attr("transform",k.replace(/rotate\(([\d\-\.]+)\)translate\(([\d\-\.]+),\s*([\d\-\.]+)\)/,function(a,b,c,d){return"rotate("+b+")translate("+-(p-l.top-l.bottom)/2+","+d+")"})))}k=g[0][0].getBBox();f="x"==f?h:{x:l.left,y:l.top};k={x:k.x+f.x,y:k.y+f.y,width:k.width,height:k.height};h={top:0,bottom:0,left:0,right:0};k.height>p&&(t=k.height-p,h.top+=.5*t,h.bottom+=.5*t);k.width>e&&(t=k.width-e,h.left+=.5*t,h.right+=.5*t);0>k.x&&(h.left+=-k.x);0>k.y&&(h.top+=-k.y);k.x+k.width>e&&(h.right+=k.x+k.width-
e);k.y+k.height>p&&(h.bottom+=k.y+k.height-p);0<h.top+h.left+h.bottom+h.right&&(c.margins=c.margins.add(h),c.I());g.attr("transform","translate("+f.x+", "+f.y+")")}b()})).then(function(){return J.prototype.m.apply(a,b)})};function ta(a,b,d){this.id=u.generatePseudoGUID(10);this.data=a;this.items=u.array.fromArguments(arguments).slice(2);this.action=b}var ua={MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",SELECT:"select",DESELECT:"deselect"};function L(a,b,d){this.M=u.generatePseudoGUID(8);this.W=a.$scope;this.ba=a.$element;this.aa=a.$attrs;this.K=a.$timeout;this.v=a.taskService;this.F=b;this.L=d;this.ca=this.v.T(this.B,this);this.fa=this.v.T(this.m,this);this.a=Promise.resolve();this.j=!0;this.Pa=this.Sa=null;this.Ga=new u.Event;this.la=!1;this.Da=Promise.resolve();var c=this;u.fast.forEach(this.L,function(a){a.changed.addListener(function(){Promise.all(u.fast.map(c.L,function(a){return a.ready})).then(function(){c.na().then(function(){c.I()})})})});
Promise.all(u.fast.map(this.L,function(a){return a.ready})).then(function(){c.na().then(function(){c.I()})});this.W.$watch(function(){return c.F},function(){c.I()},!0);this.H=!1;this.C=Promise.resolve();this.Ca=Promise.resolve()}var va={x:H.x,y:H.y,width:H.width,height:H.height,margins:H.margins};
Object.defineProperties(L.prototype,{id:{get:function(){return this.M},set:function(a){this.M=a}},render:{get:function(){throw new u.UnimplementedException('Property "render" does not exist in data source');}},settings:{get:function(){return va}},$scope:{get:function(){return this.W}},$element:{get:function(){return this.ba}},$attrs:{get:function(){return this.aa}},$timeout:{get:function(){return this.K}},options:{get:function(){return this.F}},data:{get:function(){return this.L}},sharedData:{get:function(){return this.Pa}},
thread:{get:function(){return this.Sa}},beginDrawTask:{get:function(){return this.ca}},endDrawTask:{get:function(){return this.fa}},margins:{get:function(){return this.l("margins")},set:function(a){return this.F.margins=a}},width:{get:function(){return this.l("width")},set:function(a){return this.F.width=a}},height:{get:function(){return this.l("height")},set:function(a){return this.F.height=a}},brushing:{get:function(){return this.Ga}}});n=L.prototype;
n.l=function(a){return a in this.settings?this.settings[a].D(this.options,this.$attrs,this.data,this.settings):null};n.V=function(a){return a in this.settings?this.settings[a].D(this.options,this.$attrs,this.data,this.settings).func(this.settings[a],this.options,this.$attrs,this.data,this.settings):null};n.B=function(){u.log.info("beginDraw");return Promise.resolve()};n.m=function(){u.log.info("endDraw");return Promise.resolve()};
n.ha=function(){var a=this,b=this.a;u.log.info("trying draw...");if(!this.j)return u.log.info("draw already in progress; returning."),b;this.j=!1;return this.a=b=new Promise(function(b,c){var e=a.v;Promise.resolve().then(function(){return e.j(a.beginDrawTask)}).then(function(){return e.j(a.endDrawTask)}).then(function(){a.j=!0;return Promise.resolve()}).then(b,c)})};
n.I=function(){if(!this.la){this.la=!0;var a=this.a||Promise.resolve(),b=this;this.Da=new Promise(function(d,c){a.then(function(){b.K.call(null,function(){b.la=!1;b.ha().then(d,c)},0)})})}return this.Da};n.brush=function(a,b){if(b&&b.length)switch(a.action){case ua.MOUSEOVER:this.ja(a,b);break;case ua.MOUSEOUT:this.oa(a,b)}};n.ja=function(){};n.oa=function(){};
n.na=function(){if(!this.H){this.H=!0;var a=this.C||Promise.resolve(),b=this;this.Ca=new Promise(function(d,c){a.then(function(){b.$timeout.call(null,function(){b.H=!1;b.C=b.ma();b.C.then(d,c)},0)})})}return this.Ca};n.ma=function(){return Promise.resolve()};function N(){ngu.Configuration.apply(this,arguments);this.F={}}r(N,ngu.Configuration);Object.defineProperties(N.prototype,{options:{get:function(){return this.F}}});N.prototype.a=function(a){u.extend(this.F,a)};function F(a,b){u.Exception.apply(this,arguments);this.name="UiException"}r(F,u.Exception);function wa(a){var b=a.options.parallel;if(!b)throw new F("Parallel settings have not been configured. Make sure you call configuration.customize({parallel: ...})");a=b.nthreads||16;b=b.worker;if(!b)throw new F("Parallel worker path needs to be defined in the configuration: configuration.customize({parallel: {worker: <path to worker>}})");this.Na=new parallel.ThreadPool(a,b)}Object.defineProperties(wa.prototype,{pool:{get:function(){return this.Na}}});function xa(a,b,d,c){this.a=a.options.visualizations||{};this.v=b;this.K=d;this.j=c}
xa.prototype.createNew=function(a,b,d){if(!d.vsContext)throw new F("No visual context defined for visualization");var c=a.$eval(d.vsContext);if(!c)throw new F("Undefined visual context reference: "+d.vsContext);var e=c.construct.type,f=c.construct.render;if(!this.a[e])throw new F("Undefined visualization type: "+e+". Did you forget to register it in the configuration?");if(!this.a[e][f])throw new F("Unsupported rendering for visualization type "+e+": "+f+". Supported are the following: "+Object.keys(this.a[e]||
{}).join(", ")+".");var h=u.reflection.evaluateFullyQualifiedTypeName(this.a[e][f]);if(!d.vsData)throw new F("Data source not defined for visualization: "+e+"/"+f+".");var g=a.$eval(d.vsData);if(!g)throw new F("Undefined data reference for visualization: "+e+"/"+f+".");return u.reflection.applyConstructor(h,[{$scope:a,$element:b,$attrs:d,taskService:this.v,$timeout:this.K,threadPool:this.j.pool},c.options,g])};function O(){ngu.Configuration.apply(this,arguments);this.a={};this.j={}}r(O,ngu.Configuration);O.prototype.register=function(a,b,d){a in this.a||(this.a[a]={});this.a[a][b]=d};O.prototype.Ba=function(a,b){var d=a.id,c=this.j[d];c||(c={},this.j[d]=c);var e=this.a;return u.fast.concat(u.fast.map(b,function(b){if(a.data.id==b.id)return a.items;var d=c[b.id];return d?d:(d=e[a.data.id]?e[a.data.id][b.id]:null)?d(a.data,a.items,b):[]}))};function P(a,b,d,c,e){ngu.Directive.apply(this,arguments);this.o=null;this.v=d;this.Ea=c;this.La=e;this.Ta=b}r(P,ngu.Directive);Object.defineProperties(P.prototype,{taskService:{get:function(){return this.v}},handler:{get:function(){return this.o}}});
P.prototype.link={pre:function(a,b,d){this.o=this.Ta.createNew(a,b,d);b.css({top:(this.o.options.y||0)+"px",left:(this.o.options.x||0)+"px",width:this.o.options.width+"px",height:this.o.options.height+"px"})},post:function(a,b){var d=this;b.on("resizeend",function(a){d.o.options.width=a.width;d.o.options.height=a.height;d.o.I()});this.handler.brushing.addListener(function(a){this.Ea.$broadcast("brushing",a)},this);a.$on("brushing",function(a,b){var f=d.La.Ba(b,d.handler.data);d.handler.brush(b,f)})}};function R(a,b,d,c){ngu.Directive.apply(this,arguments);this.v=b;this.K=d;this.o=null;this.a=!!c}r(R,ngu.Directive);Object.defineProperties(R.prototype,{handler:{get:function(){return this.o}}});
R.prototype.link=function(a,b,d,c){ngu.Directive.prototype.link.post.apply(this,arguments);var e=a.visualization,f=d.vsOptions?a.$eval(d.vsOptions):{};this.o=this.S({$scope:a,$element:b,$attrs:d,taskService:this.v,$timeout:this.K},b.parent(),e.handler,f);this.a?(this.v.a(e.handler.endDrawTask,this.o.endDrawTask),this.v.a(this.o.beginDrawTask,e.handler.beginDrawTask)):(this.v.a(this.o.endDrawTask,e.handler.endDrawTask),this.v.a(e.handler.beginDrawTask,this.o.beginDrawTask))};
R.prototype.S=function(){throw new u.AbstractMethodException("Method not implemented");};function ya(a,b){this.x=a;this.y=b};function S(a){this.a=a}n=S.prototype;n.U=function(a){return this.a.call(null,a)};n.O=function(a){a=this.U(a);return[a.x,a.y]};n.Va=function(a){return this.a.call(null,{x:a}).x};n.Wa=function(a){return this.a({y:a}).y};n.Y=function(a){var b=this;return a instanceof S?new S(function(d){return a.U(b.U(d))}):new S(function(d){return a.call(null,b.U(d))})};n.translate=function(a){return this.Y(za(a))};n.scale=function(a,b){return this.Y(Aa(a,b))};n.ka=function(){return this.Y(Ba())};
function za(a){return new S(function(b){return new ya(void 0!=b.x?b.x+a.x:void 0,void 0!=b.y?b.y+a.y:void 0)})}function Aa(a,b){return new S(function(d){return new ya(void 0!=d.x?a(d.x):void 0,void 0!=d.y?b(d.y):void 0)})}function Ba(){return new S(function(a){return new ya(Math.floor(a.x),Math.floor(a.y))})};function T(a,b,d,c){J.apply(this,arguments)}r(T,J);
T.prototype.m=function(){var a=this,b=arguments;return(new Promise(function(b){if(ea(a.target.data)){var c=a.target,e=a.type,f={top:0,bottom:0,left:0,right:0};"x"==e&&25>c.margins.bottom&&(f.bottom=25-c.margins.bottom);if(0<f.top+f.bottom+f.left+f.right)c.margins=c.margins.add(f),c.I();else{var h=c.height,g=c.width,p=c.margins,l=Ba(),k=za({x:p.left,y:p.top}).ka(),m=c.pendingCanvas[0].getContext("2d"),t=m.__proto__.moveTo,Q=m.__proto__.lineTo,B="x"==e?c.l("xScale"):c.l("yScale");if(!B)throw new F('Visualization must have "xScale"/"yScale" settings defined in order to use the Axis decorator');
m.strokeStyle="#000000";m.lineWidth=1;m.font="17px Times New Roman";m.fillStyle="#000000";var M=B.ticks(a.ticks),ra=u.fast.map(M,B.tickFormat(a.ticks,a.format)),Na=Math.max.apply(null,u.fast.map(ra,function(a){return m.measureText(a).width}))+11;if("y"==e&&p.left<Na)f.left=Na-p.left,c.margins=p.add(f),c.I();else{c={x:p.left,y:h-p.bottom};m.beginPath();t.apply(m,l.O(c));switch(e){case "x":Q.apply(m,l.O({x:g-p.right,y:c.y}));break;case "y":Q.apply(m,l.O({x:c.x,y:p.top}))}var Va="x"==e?B:function(){return 0},
Oa="x"==e?B:function(){return-6},Wa="y"==e?B:function(){return h-p.top-p.bottom},Pa="y"==e?B:function(){return h-p.top-p.bottom+6};u.fast.forEach(M,function(a){t.apply(m,k.O({x:Va(a),y:Wa(a)}));Q.apply(m,k.O({x:Oa(a),y:Pa(a)}))});m.stroke();"x"==e?(m.textAlign="center",m.textBaseline="top"):(m.textAlign="right",m.textBaseline="middle",k=k.translate({x:-5,y:0}));u.fast.forEach(ra,function(a,b){var c=k.U({x:Oa(M[b]),y:Pa(M[b])});m.fillText(a,c.x,c.y)})}}}b()})).then(function(){return J.prototype.m.apply(a,
b)})};function Ca(){R.apply(this,arguments)}r(Ca,R);Ca.prototype.S=function(a,b,d,c){switch(d.render){case "svg":return new K(a,b,d,c);case "canvas":return new T(a,b,d,c)}return null};function Da(a,b,d){ngu.Directive.apply(this,arguments);this.v=b;this.K=d}r(Da,ngu.Directive);
Da.prototype.link=function(a,b,d,c){function e(){if(null!=p)return Promise.resolve();if(null!=l)return clearTimeout(l),l=null,Promise.resolve();p=setTimeout(function(){p=null;B.css({"-webkit-transition":"none","-o-transition":"none",transition:"none"});B.css("width","0");m.css("display","block");u.reflowForTransition(m[0]);m.css("opacity","1");t.css("display","block");u.reflowForTransition(t[0]);t.css("opacity","1");k=setInterval(h,500)},500);return Promise.resolve()}function f(){if(null!=l)return Promise.resolve();
if(null!=p)return clearTimeout(p),p=null,Promise.resolve();l=setTimeout(function(){l=null;clearInterval(k);m.one("transitionend",function(){m.css("display","none")});m.css("opacity",0);t.one("transitionend",function(){t.css("display","none")});t.css("opacity",0);B.css("width","100%")},500);return Promise.resolve()}function h(){B.css({"-webkit-transition":"","-o-transition":"",transition:""});var a=B.css("width"),a=void 0==a||0<=a.indexOf("px")?B.width()/Q.width()*100:parseInt(a,10);99<=a||(a=Math.min(a+
Math.ceil(.25*(100-a)),99),B.css("width",a+"%"))}ngu.Directive.prototype.link.post.apply(this,arguments);var g=a.visualization.handler,p=null,l=null,k=null,m=$('<div class="vs-loading-overlay" style="opacity: 0; display: none;"></div>').appendTo(b),t=$('<div class="vs-loading-container" style="opacity: 0; display: none;"></div>').appendTo(b),Q=$('<div class="progress" ></div>').appendTo(t),B=$('<div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0"> </div>').appendTo(Q);
b.on("resizestart",function(){m.css("display","block");u.reflowForTransition(m[0]);m.css("opacity","1")});b.on("resizeend",function(){g.I().then(function(){m.one("transitionend",function(){m.css("display","none")});m.css("opacity","0")})});var M=g.data;u.fast.forEach(M,function(a){a.changing.addListener(e)});u.fast.forEach(M,function(a){a.changed.addListener(function(){Promise.all(u.fast.map(M,function(a){return a.ready})).then(f)})});this.v.a(g.endDrawTask,this.v.T(f));this.v.a(this.v.T(e),g.beginDrawTask)};function U(a,b){u.Exception.apply(this,arguments);this.name="ModelsException"}r(U,u.Exception);function Ea(a,b,d){b=parseInt(b,10);d=parseInt(d,10);this.Oa=[new x({target:"chr",test:y.EQUALS,testArgs:a}),new x({target:"start",test:y.LESS_THAN,testArgs:d}),new x({target:"end",test:y.GREATER_OR_EQUALS,testArgs:b})];this.Ia=a;this.Qa=b;this.Ja=d}Object.defineProperties(Ea.prototype,{chr:{get:function(){return this.Ia}},start:{get:function(){return this.Qa}},end:{get:function(){return this.Ja}},query:{get:function(){return this.Oa}}});function V(a,b,d,c){I.apply(this,arguments)}r(V,I);var Fa={type:new D({key:"type",type:E.CATEGORICAL,defaultValue:"x",possibleValues:["x","y"]}),ticks:new D({key:"ticks",type:E.NUMBER,defaultValue:10}),format:new D({key:"format",type:E.STRING,defaultValue:"s"})};Object.defineProperties(V.prototype,{settings:{get:function(){return Fa}},type:{get:function(){return this.l("type")}},ticks:{get:function(){return this.l("ticks")}},format:{get:function(){return this.l("format")}}});function Ga(a,b,d,c){V.apply(this,arguments)}r(Ga,V);
Ga.prototype.m=function(){var a=this,b=arguments;return(new Promise(function(b){if(ea(a.target.data)){var c=a.target,e=d3.select(c.$element[0]).select("svg"),f=a.type,h="grid-"+f,g=e.select("."+h);g.empty()&&(g=e.insert("g",".viewport").attr("class",h));var h=c.height,p=c.width,e=c.margins,c="x"==f?c.V("xScale"):c.V("yScale");if(!c)throw new F('Visualization must have "xScale"/"yScale" settings defined in order to use the Grid decorator');g=g.selectAll(".grid-line").data(c.ticks(a.ticks));g.enter().append("line").attr("class",
"grid-line");var l="x"==f?c:0,p="x"==f?c:p-e.left-e.right,k="y"==f?c:0,f="y"==f?c:h-e.top-e.bottom;g.attr("transform","translate("+e.left+", "+e.top+")").attr("x1",l).attr("x2",p).attr("y1",k).attr("y2",f).style("stroke","#eeeeee").style("shape-rendering","crispEdges");g.exit().remove()}b()})).then(function(){return V.prototype.m.apply(a,b)})};function Ha(a,b,d,c){V.apply(this,arguments)}r(Ha,V);
Ha.prototype.m=function(){var a=this,b=arguments;return(new Promise(function(b){if(ea(a.target.data)){var c=a.target,e=a.type,f=c.margins,h=c.height,g=c.width,p=za({x:f.left,y:f.top}).ka(),l=c.pendingCanvas[0].getContext("2d"),k=l.__proto__.moveTo,m=l.__proto__.lineTo,c="x"==e?c.l("xScale"):c.l("yScale");if(!c)throw new F('Visualization must have "xScale"/"yScale" settings defined in order to use the Grid decorator');l.strokeStyle="#eeeeee";l.lineWidth=1;var t=c.ticks(a.ticks),Q="x"==e?c:function(){return 0},
B="x"==e?c:function(){return g-f.left-f.right},M="y"==e?c:function(){return 0},ra="y"==e?c:function(){return h-f.top-f.bottom};u.fast.forEach(t,function(a){k.apply(l,p.O({x:Q(a),y:M(a)}));m.apply(l,p.O({x:B(a),y:ra(a)}))});l.stroke()}b()})).then(function(){return V.prototype.m.apply(a,b)})};function Ia(a,b,d){R.apply(this,arguments)}r(Ia,R);Ia.prototype.S=function(a,b,d,c){switch(d.render){case "svg":return new Ga(a,b,d,c);case "canvas":return new Ha(a,b,d,c)}return null};function Ja(a,b){ngu.Directive.apply(this,arguments);this.a=b}r(Ja,ngu.Directive);
Ja.prototype.link=function(a,b,d,c){function e(a){a.stopPropagation();a.preventDefault();var c=a.pageX-p;k.top=a.pageY-l;k.left=c;a=g;var c=k,d,e;e=d=65;switch(c){case a.c:c.top=Math.min(c.top,a.G.top-c.height-2*a.A-e);c.left=Math.min(c.left,a.J.left-c.width-2*a.A-d);a.G.left=c.left;a.J.top=c.top;a.j.left=c.left;break;case a.G:c.top=Math.max(c.top,a.c.top+a.c.height+2*a.A+e);c.left=Math.min(c.left,a.J.left-c.width-2*a.A-d);a.c.left=c.left;a.a.top=c.top;a.j.left=c.left;a.H.top=c.top;break;case a.J:c.top=
Math.min(c.top,a.G.top-c.height-2*a.A-e);c.left=Math.max(c.left,a.c.left+a.c.width+2*a.A+d);a.c.top=c.top;a.a.left=c.left;a.C.left=c.left;break;case a.a:c.top=Math.max(c.top,a.c.top+a.c.height+2*a.A+e);c.left=Math.max(c.left,a.c.left+a.c.width+2*a.A+d);a.J.left=c.left;a.G.top=c.top;a.C.left=c.left;a.H.top=c.top;break;case a.j:c.top=a.c.top;c.left=Math.min(c.left,a.C.left-c.width-2*a.A-d);a.c.left=c.left;a.G.left=c.left;break;case a.C:c.top=a.c.top;c.left=Math.max(c.left,a.j.left+a.j.width+2*a.A+d);
a.J.left=c.left;a.a.left=c.left;break;case a.H:c.left=a.c.left,c.top=Math.max(c.top,a.c.top+a.c.height+2*a.A+e),a.a.top=c.top,a.G.top=c.top}h.css({top:g.top+"px",left:g.left+"px",width:g.width+"px",height:g.height+"px"});b.css({top:g.top+"px",left:g.left+"px",width:g.width+"px",height:g.height+"px"});h.trigger($.Event("resize",{top:g.top,left:g.left,width:g.width,height:g.height}));b.trigger($.Event("resize",{top:g.top,left:g.left,width:g.width,height:g.height}))}function f(a){a.preventDefault();
a.stopPropagation();m.a.off("mousemove",e);m.a.off("mouseup",f);h.trigger($.Event("resizeend",{top:g.top,left:g.left,width:g.width,height:g.height}));b.trigger($.Event("resizeend",{top:g.top,left:g.left,width:g.width,height:g.height}))}ngu.Directive.prototype.link.post.apply(this,arguments);var h=a.vsWindow.$window;h.append('<div class="vs-resize-grab vs-grab-diagonal vs-grab-top-left"></div>').append('<div class="vs-resize-grab vs-grab-diagonal vs-grab-top-right"></div>').append('<div class="vs-resize-grab vs-grab-diagonal vs-grab-bottom-left"></div>').append('<div class="vs-resize-grab vs-grab-diagonal vs-grab-bottom-right"></div>').append('<div class="vs-resize-grab vs-grab-vertical vs-grab-left"></div>').append('<div class="vs-resize-grab vs-grab-vertical vs-grab-right"></div>').append('<div class="vs-resize-grab vs-grab-horizontal vs-grab-bottom"></div>');
var g,p,l,k,m=this;h.find("> .vs-resize-grab").on("mousedown",function(a){a.stopPropagation();a.preventDefault();g=new Ka(h);k=La(g,$(this));p=a.pageX-k.left;l=a.pageY-k.top;m.a.on("mousemove",e);m.a.on("mouseup",f);h.trigger($.Event("resizestart",{}));b.trigger($.Event("resizestart",{}))})};
function W(a){this.a=a;var b=a[0].getBoundingClientRect(),d=a.position().left+a.parent().position().left+1;this.top=a.position().top+a.parent().position().top+1;this.left=d;this.width=b.width;this.height=b.height}
function Ka(a){a.position();this.c=new W(a.find("> .vs-grab-top-left"));this.J=new W(a.find("> .vs-grab-top-right"));this.G=new W(a.find("> .vs-grab-bottom-left"));this.a=new W(a.find("> .vs-grab-bottom-right"));this.j=new W(a.find("> .vs-grab-left"));this.C=new W(a.find("> .vs-grab-right"));this.H=new W(a.find("> .vs-grab-bottom"));this.A=.5*-this.c.width-1}
function La(a,b){switch(b[0]){case a.c.a[0]:return a.c;case a.G.a[0]:return a.G;case a.J.a[0]:return a.J;case a.a.a[0]:return a.a;case a.j.a[0]:return a.j;case a.C.a[0]:return a.C;case a.H.a[0]:return a.H;default:return null}}
Object.defineProperties(Ka.prototype,{left:{get:function(){return this.c.left+this.c.width+this.A}},top:{get:function(){return this.c.top+this.c.height+this.A}},width:{get:function(){return this.J.left-this.c.left-this.c.width-2*this.A-2}},height:{get:function(){return this.G.top-this.c.top-this.c.height-this.A-1}}});function X(){ngu.Directive.apply(this,arguments);this.pa=null}r(X,ngu.Directive);Object.defineProperties(X.prototype,{$window:{get:function(){return this.pa}}});
X.prototype.link={pre:function(a,b,d,c){ngu.Directive.prototype.link.pre.apply(this,arguments);var e=$('<div class="vs-window-container"></div>').appendTo(b.parent()),f=a.$eval(d.vsStyle||"{}"),f={top:f.top||(b.css("top")?parseInt(b.css("top"),10)+parseInt(e.css("padding-top"),10)+"px":void 0),left:f.left||b.css("left")||void 0,bottom:f.bottom||b.css("bottom")||void 0,right:f.right||b.css("right")||void 0,width:f.width||b.width()+"px",height:f.height||b.height()+"px"};e.css(f);b.css({top:"",left:"",
bottom:"",right:""});e.append(b);e.on("mousedown",function(){e.siblings().css("zIndex",1031);e.css("zIndex",1032)});this.pa=e},post:ngu.Directive.prototype.link.post};function Ma(a,b){ngu.Directive.apply(this,arguments);this.a=b}r(Ma,ngu.Directive);
Ma.prototype.link=function(a,b,d,c){function e(a){k=a.pageY-p;l=a.pageX-g;h.css({top:k+"px",left:l+"px"})}function f(){m.off("mousemove",e);m.off("mouseup",f)}ngu.Directive.prototype.link.post.apply(this,arguments);var h=a.vsWindow.$window;h.css({cursor:"move"});var g=0,p=0,l,k,m=this.a;h.on("mousedown",function(a){if(a.target==h[0]){a.preventDefault();var b=h.position();l=b.left;k=b.top;g=a.pageX-l;p=a.pageY-k;m.on("mousemove",e);m.on("mouseup",f)}})};function Qa(a){this.L=a.data;this.ra=new u.Event;var b=new u.EventListener(function(a){this.ra.fire(a)},this);u.fast.forEach(this.L,function(a){a.changed.addListener(b)});this.Ua=a.visualizations||[];this.Ha=a.children||[];this.Ma=a.name||""}Object.defineProperties(Qa.prototype,{name:{get:function(){return this.Ma}},data:{get:function(){return this.L},set:function(a){this.L=a}},dataChanged:{get:function(){return this.ra}},children:{get:function(){return this.Ha}},visualizations:{get:function(){return this.Ua}}});
Qa.prototype.a=function(a){return Promise.all(u.fast.map(this.data,function(b){return b.X(a)}))};function Ra(a,b){ngu.Directive.apply(this,arguments);this.j=b;this.o=null;this.a={}}r(Ra,ngu.Directive);Object.defineProperties(Ra.prototype,{handler:{get:function(){return this.o}}});
Ra.prototype.link=function(a,b){for(var d in a)if(a.hasOwnProperty(d)&&a[d]instanceof Qa){this.o=a[d];break}if(!this.o)throw new F("No vs.ui.DataHandler instance found in current scope");a.dataHandler=this.o;var c=this,e=this.j;a.$watchCollection(function(){return c.o.visualizations},function(d){var h={};u.fast.forEach(d,function(d,f){var l=d.id;void 0==l&&(d.id=l=u.generatePseudoGUID(8));h[l]=d;if(!(l in c.a)){var k=$(Sa('<div vs-context="dataHandler.visualizations[%s]" vs-data="dataHandler.data" class="visualization %s" id="vs-%s"></div>',
f,d.decorators.cls.join(" "),l)).appendTo(b);u.fast.forEach(d.decorators.elem,function(a,b){$(Sa('<div class="%s" vs-options="dataHandler.visualizations[%s].decorators.elem[%s].options"></div>',a.cls,f,b)).appendTo(k)});c.a[l]=d;e(k)(a)}});u.each(c.a,function(a){a in h||$("vs-"+a).remove()})})};function Ta(){L.apply(this,arguments)}r(Ta,L);Object.defineProperties(Ta.prototype,{render:{get:function(){return"svg"}}});Ta.prototype.B=function(){var a=this,b=arguments;return new Promise(function(d,c){L.prototype.B.apply(a,b).then(function(){d3.select(a.$element[0]).select("svg").empty()&&d3.select(a.$element[0]).append("svg").attr("width","100%").attr("height","100%").append("rect").style("fill","#ffffff").attr("width","100%").attr("height","100%");d()},c)})};var Ua=String.prototype.repeat?function(a,b){return a.repeat(b)}:function(a,b){return Array(b+1).join(a)};Math.random();function Sa(a,b){var d=Array.prototype.slice.call(arguments),c=d.shift();if("undefined"==typeof c)throw Error("[goog.string.format] Template required");return c.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(a,b,c,g,p,l,k,m){if("%"==l)return"%";var t=d.shift();if("undefined"==typeof t)throw Error("[goog.string.format] Not enough arguments");arguments[0]=t;return Xa[l].apply(null,arguments)})}
var Xa={s:function(a,b,d){return isNaN(d)||""==d||a.length>=d?a:a=-1<b.indexOf("-",0)?a+Ua(" ",d-a.length):Ua(" ",d-a.length)+a},f:function(a,b,d,c,e){c=a.toString();isNaN(e)||""==e||(c=parseFloat(a).toFixed(e));var f;f=0>a?"-":0<=b.indexOf("+")?"+":0<=b.indexOf(" ")?" ":"";0<=a&&(c=f+c);if(isNaN(d)||c.length>=d)return c;c=isNaN(e)?Math.abs(a).toString():Math.abs(a).toFixed(e);a=d-c.length-f.length;0<=b.indexOf("-",0)?c=f+c+Ua(" ",a):(b=0<=b.indexOf("0",0)?"0":" ",c=f+Ua(b,a)+c);return c},d:function(a,
b,d,c,e,f,h,g){return Xa.f(parseInt(a,10),b,d,c,0,f,h,g)}};Xa.i=Xa.d;Xa.u=Xa.d;function Y(){L.apply(this,arguments);this.R=this.P=this.N=null}r(Y,L);var Ya=u.extend({},va,{doubleBuffer:H.doubleBuffer});Object.defineProperties(Y.prototype,{render:{get:function(){return"canvas"}},settings:{get:function(){return Ya}},doubleBuffer:{get:function(){return this.l("doubleBuffer")},set:function(a){return this.options.doubleBuffer=a}},pendingCanvas:{get:function(){return this.N}},activeCanvas:{get:function(){return this.doubleBuffer?this.P:this.N}},brushingCanvas:{get:function(){return this.R}}});
Y.prototype.B=function(){var a=this,b=arguments;return new Promise(function(d,c){L.prototype.B.apply(a,b).then(function(){var b=a.N,c=a.P;b&&c||(b=Sa('<canvas width="%s" height="%s" style="display: %%s"></canvas>',a.l("width"),a.l("height")),c=$(Sa(b,"block")).appendTo(a.$element),b=a.doubleBuffer?$(Sa(b,"none")).appendTo(a.$element):c,a.N=b,a.P=c,Za(a));b.attr("width",a.l("width")).attr("height",a.l("height"));c=b[0].getContext("2d");c.translate(.5,.5);c.rect(0,0,a.l("width"),a.l("height"));c.fillStyle=
"#ffffff";c.fill();d()},c)})};Y.prototype.m=function(){var a=this,b=arguments;return(new Promise(function(b){if(a.doubleBuffer){a.P.css({display:"none"});a.N.css({display:"block"});var c=a.P;a.P=a.N;a.N=c}b()})).then(function(){return L.prototype.m.apply(a,b)})};Y.prototype.ia=function(){return[]};
function Za(a){function b(b){c.getBoundingClientRect();b=a.ia(b.offsetX,b.offsetY);if(b.length||f.length){var d=!1;if(10<b.length||10<f.length||b.length!=f.length)d=!0;var l;if(!d)for(l=0;l<b.length;++l)if(0>f.indexOf(b[l])){d=!0;break}if(d&&(e&&(u.each(e,function(b,c){a.brushing.fire(u.reflection.applyConstructor(ta,[h[b],ua.MOUSEOUT].concat(c)))}),e=null),f=b,b.length)){e={};for(l=0;l<b.length;++l){var d=b[l],k=d.__d__,m=e[k];m||(m=[],e[k]=m);m.push(d)}u.each(e,function(b,c){a.brushing.fire(u.reflection.applyConstructor(ta,
[h[b],ua.MOUSEOVER].concat(c)))})}}}if(!a.R){var d=Sa('<canvas width="%s" height="%s" style="display: none; position: absolute; bottom: 0; left: 0;"></canvas>',a.l("width"),a.l("height"));a.R=$(d);a.R.appendTo(a.$element)}var c=a.P[0],e=null,f=[],h=u.mapToObject(a.data,function(a){return{key:a.id,value:a}});c.addEventListener("mousemove",b);c.addEventListener("mouseover",b);c.addEventListener("mouseout",b);a.R[0].addEventListener("mouseover",b);a.R[0].addEventListener("mousemove",b);a.R[0].addEventListener("mouseout",
b);a.doubleBuffer&&(d=a.N[0],d.addEventListener("mousemove",b),d.addEventListener("mouseover",b),d.addEventListener("mouseout",b))};var Z=angular.module("vs",[]);Z.provider("configuration",function(){return new N});Z.provider("link",function(){return new O});Z.factory("taskService",["$timeout",function(){return new w}]);Z.factory("threadPool",["configuration",function(a){return new wa(a)}]);Z.factory("visualizationFactory",["configuration","taskService","$timeout","threadPool",function(a,b,d,c){return new xa(a,b,d,c)}]);
Z.directive("visualization",["visualizationFactory","taskService","$rootScope","link",function(){return ngu.Directive.createNew("visualization",P,u.array.fromArguments(arguments),{restrict:"C"})}]);Z.directive("vsDataContext",["$compile",function(){return ngu.Directive.createNew("vsDataContext",Ra,u.array.fromArguments(arguments),{restrict:"C"})}]);Z.directive("vsWindow",function(){return ngu.Directive.createNew("vsWindow",X,null,{restrict:"C"})});
Z.directive("vsMovable",["$document",function(){return ngu.Directive.createNew("vsMovable",Ma,u.array.fromArguments(arguments),{restrict:"C",require:"vsWindow"})}]);Z.directive("vsResizable",["$document",function(){return ngu.Directive.createNew("vsResizable",Ja,u.array.fromArguments(arguments),{restrict:"C",require:"vsWindow"})}]);Z.directive("vsLoader",["taskService","$timeout",function(){return ngu.Directive.createNew("vsLoader",Da,u.array.fromArguments(arguments),{restrict:"C",require:"^visualization"})}]);
Z.directive("vsAxis",["taskService","$timeout",function(){return ngu.Directive.createNew("vsAxis",Ca,u.array.fromArguments(arguments),{restrict:"C",require:"^visualization"})}]);Z.directive("vsGrid",["taskService","$timeout",function(){return ngu.Directive.createNew("vsGrid",Ia,u.array.fromArguments(arguments),{restrict:"C",require:"^visualization"})}]);Z.factory("$exceptionHandler",function(){return function(a,b){console.error(a,b)}});q("vs.async.TaskService",w);w.prototype.createTask=w.prototype.T;w.prototype.chain=w.prototype.a;w.prototype.runChain=w.prototype.j;q("vs.async.Task",v);v.nextId=function(){return ba++};q("vs.async.ThreadPoolService",wa);q("vs.Configuration",N);N.prototype.customize=N.prototype.a;q("vs.directives.Axis",Ca);Ca.prototype.createDecorator=Ca.prototype.S;q("vs.directives.DataContext",Ra);q("vs.directives.GraphicDecorator",R);R.prototype.link=R.prototype.link;void 0==Object.getOwnPropertyDescriptor(R.prototype,"createDecorator")&&Object.defineProperty(R.prototype,"createDecorator",{configurable:!0,enumerable:!0,get:function(){return this.S},set:function(a){this.S=a}});q("vs.directives.Grid",Ia);Ia.prototype.createDecorator=Ia.prototype.S;q("vs.directives.LoadingDecorator",Da);Da.prototype.link=Da.prototype.link;q("vs.directives.Movable",Ma);Ma.prototype.link=Ma.prototype.link;q("vs.directives.Resizable",Ja);Ja.prototype.link=Ja.prototype.link;q("vs.directives.Visualization",P);P.prototype.link=P.prototype.link;q("vs.directives.Window",X);X.prototype.link=X.prototype.link;q("vs.linking.LinkProvider",O);O.prototype.register=O.prototype.register;O.prototype.brushingObjects=O.prototype.Ba;q("vs.models.Boundaries",C);q("vs.models.DataSource",z);z.prototype.filter=z.prototype.filter;z.prototype.raw=z.prototype.raw;z.prototype.getRowMetadata=z.prototype.Z;z.singleQuery=ca;z.combinedArrayMetadata=da;z.allDataIsReady=ea;void 0==Object.getOwnPropertyDescriptor(z.prototype,"applyQuery")&&Object.defineProperty(z.prototype,"applyQuery",{configurable:!0,enumerable:!0,get:function(){return this.X},set:function(a){this.X=a}});q("vs.models.GenomicRangeQuery",Ea);
Ea.extract=function(a){var b=["chr","start","end"],d=["=="],c=["<",">="];a=u.array.uniqueKey(a,function(a){return a.toString()});a=u.fast.filter(a,function(a){if(0>b.indexOf(a.target))return!1;if("chr"==a.target&&0>d.indexOf(a.test)||a.negate)throw new U("The "+a.test+" operation is not yet supported for chromosomes; supported operations are: "+JSON.stringify(d));if(("start"==a.target||"end"==a.target)&&0>c.indexOf(a.test))throw new U("The "+a.test+" operation is not yet supported for start/end positions by the bigwig library; supported operations are: "+JSON.stringify(c));
if("start"==a.target&&(">="==a.test||"<"==a.test&&a.negate))throw new U('The only supported test for "start" is "<"');if("end"==a.target&&("<"==a.test||">="==a.test&&a.negate))throw new U('The only supported test for "end" is ">="');return!0});var e=u.fast.filter(a,function(a){return"chr"==a.target&&!a.negate}),f=u.fast.filter(a,function(a){return"start"==a.target||"end"==a.target}),h=u.fast.filter(f,function(a){return">="==a.test||a.negate&&"<"==a.test}),g=u.fast.filter(f,function(a){return"<"==
a.test||a.negate&&">="==a.test});if(0<a.length&&1!=e.length)throw new U('Valid queries must either be empty, or contain exactly one "chr == " test');if(0<a.length&&2>f.length)throw new U('Valid queries must either be empty, or contain at least two "start/end < or >= " tests');if(0<a.length&&(1>g.length||1>h.length))throw new U("Valid queries must either be empty, or contain a finite start/end range");a=0==a.length?void 0:{Xa:e[0].testArgs,end:u.fast.filter(f,function(a){return"start"==a.target}).map(function(a){return a.testArgs}).reduce(function(a,
b){return Math.min(a,b)}),start:u.fast.filter(f,function(a){return"end"==a.target}).map(function(a){return a.testArgs}).reduce(function(a,b){return Math.max(a,b)})};return new Ea(a.Xa,a.start,a.end)};q("vs.models.Margins",A);A.prototype.add=A.prototype.add;A.prototype.equals=A.prototype.equals;q("vs.models.ModelsException",U);q("vs.models.Point",ya);q("vs.models.Query",x);x.prototype.equals=x.prototype.equals;q("vs.models.Query.Target",{ROWS:"rows",COLS:"cols",VALS:"vals"});q("vs.models.Query.Test",y);q("vs.models.Transformer",S);S.prototype.calc=S.prototype.U;S.prototype.calcArr=S.prototype.O;S.prototype.calcX=S.prototype.Va;S.prototype.calcY=S.prototype.Wa;S.prototype.combine=S.prototype.Y;S.prototype.translate=S.prototype.translate;S.prototype.scale=S.prototype.scale;S.prototype.intCoords=S.prototype.ka;S.translate=za;S.scale=Aa;S.intCoords=Ba;q("vs.ui.BrushingEvent",ta);q("vs.ui.BrushingEvent.Action",ua);q("vs.ui.canvas.CanvasAxis",T);T.prototype.endDraw=T.prototype.m;q("vs.ui.canvas.CanvasGrid",Ha);Ha.prototype.endDraw=Ha.prototype.m;q("vs.ui.canvas.CanvasVis",Y);Y.Settings=Ya;Y.circle=function(a,b,d,c,e,f,h){a.beginPath();a.arc(b,d,c,0,2*Math.PI);f&&(a.strokeStyle=f,a.lineWidth=h||0,a.stroke());e&&(a.fillStyle=e,a.fill());a.closePath()};void 0==Object.getOwnPropertyDescriptor(Y.prototype,"beginDraw")&&Object.defineProperty(Y.prototype,"beginDraw",{configurable:!0,enumerable:!0,get:function(){return this.B},set:function(a){this.B=a}});
void 0==Object.getOwnPropertyDescriptor(Y.prototype,"endDraw")&&Object.defineProperty(Y.prototype,"endDraw",{configurable:!0,enumerable:!0,get:function(){return this.m},set:function(a){this.m=a}});void 0==Object.getOwnPropertyDescriptor(Y.prototype,"getItemsAt")&&Object.defineProperty(Y.prototype,"getItemsAt",{configurable:!0,enumerable:!0,get:function(){return this.ia},set:function(a){this.ia=a}});q("vs.ui.DataHandler",Qa);Qa.prototype.query=Qa.prototype.a;q("vs.ui.Decorator",I);I.prototype.optionValue=I.prototype.l;void 0==Object.getOwnPropertyDescriptor(I.prototype,"beginDraw")&&Object.defineProperty(I.prototype,"beginDraw",{configurable:!0,enumerable:!0,get:function(){return this.B},set:function(a){this.B=a}});void 0==Object.getOwnPropertyDescriptor(I.prototype,"endDraw")&&Object.defineProperty(I.prototype,"endDraw",{configurable:!0,enumerable:!0,get:function(){return this.m},set:function(a){this.m=a}});q("vs.ui.decorators.Axis",J);J.Settings=qa;q("vs.ui.decorators.Grid",V);q("vs.ui.Setting",D);D.prototype.getValue=D.prototype.D;D.prototype.possibleValues=D.prototype.j;D.prototype.copy=D.prototype.copy;q("vs.ui.Setting.Type",E);q("vs.ui.Setting.FunctionWrapper",G);D.boundaries=ha;D.xBoundaries=ia;D.yBoundaries=ja;D.firstColsId=ka;D.firstRowsLabel=la;D.xScale=na;D.yScale=oa;D.PredefinedSettings=H;q("vs.ui.svg.SvgAxis",K);K.prototype.endDraw=K.prototype.m;q("vs.ui.svg.SvgGrid",Ga);Ga.prototype.endDraw=Ga.prototype.m;q("vs.ui.svg.SvgVis",Ta);Ta.prototype.beginDraw=Ta.prototype.B;q("vs.ui.VisHandler",L);L.Settings=va;L.prototype.optionValue=L.prototype.l;L.prototype.optionFunctionValue=L.prototype.V;L.prototype.scheduleRedraw=L.prototype.I;L.prototype.schedulePreProcessData=L.prototype.na;void 0==Object.getOwnPropertyDescriptor(L.prototype,"draw")&&Object.defineProperty(L.prototype,"draw",{configurable:!0,enumerable:!0,get:function(){return this.ha},set:function(a){this.ha=a}});
void 0==Object.getOwnPropertyDescriptor(L.prototype,"preProcessData")&&Object.defineProperty(L.prototype,"preProcessData",{configurable:!0,enumerable:!0,get:function(){return this.ma},set:function(a){this.ma=a}});void 0==Object.getOwnPropertyDescriptor(L.prototype,"beginDraw")&&Object.defineProperty(L.prototype,"beginDraw",{configurable:!0,enumerable:!0,get:function(){return this.B},set:function(a){this.B=a}});
void 0==Object.getOwnPropertyDescriptor(L.prototype,"endDraw")&&Object.defineProperty(L.prototype,"endDraw",{configurable:!0,enumerable:!0,get:function(){return this.m},set:function(a){this.m=a}});void 0==Object.getOwnPropertyDescriptor(L.prototype,"highlightItem")&&Object.defineProperty(L.prototype,"highlightItem",{configurable:!0,enumerable:!0,get:function(){return this.ja},set:function(a){this.ja=a}});
void 0==Object.getOwnPropertyDescriptor(L.prototype,"unhighlightItem")&&Object.defineProperty(L.prototype,"unhighlightItem",{configurable:!0,enumerable:!0,get:function(){return this.oa},set:function(a){this.oa=a}});q("vs.ui.VisualContext",function(a,b,d,c){this.id=c;this.construct=a;this.options=b||{};this.decorators=d||[]});q("vs.ui.VisualizationFactory",xa);xa.prototype.createNew=xa.prototype.createNew;}).call(this); //# sourceMappingURL=vis.min.js.map
